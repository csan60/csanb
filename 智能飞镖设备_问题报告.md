# CST2025嵌入式分赛 - 智能飞镖感应设备问题报告

**项目名称**：智能飞镖感应设备测试  
**被测软件**：Dart.exe  
**测试日期**：2024-11-15  
**报告版本**：1.0  

---

## 📊 问题汇总表

| 序号 | 需求编号 | 问题等级 | 问题描述摘要 | 状态 |
|------|----------|----------|--------------|------|
| 1 | 接口需求 | 🔴 高 | 数据传送机接口包头校验缺失 | 待修复 |
| 2 | 接口需求 | 🔴 高 | 靶体接口包头校验缺失 | 待修复 |

**问题总数**：2个  
**高优先级**：2个  
**中优先级**：0个  
**低优先级**：0个  

---

## 🐛 问题详细描述

### 问题1：数据传送机接口包头校验缺失

| 项目 | 内容 |
|------|------|
| **需求编号** | 接口需求 |
| **问题等级** | 🔴 高 |
| **测试用例描述** | 测试数据传送机接口处理错误数据包的能力，验证当发送包头错误的shoot协议数据包时，系统是否正确进行丢包处理 |
| **输入** | 包头错误的shoot协议数据包<br>- 包头：0x5511（错误，应为0xAA55）<br>- 数据标志：0xBB<br>- 飞镖类型：0x01<br>- 飞镖数量：0x05<br>- 校验和：计算正确<br>- 包尾：0x55AA |
| **预期输出** | - 系统检测到包头错误（0x5511 ≠ 0xAA55）<br>- 系统丢弃整个数据包<br>- 系统不显示任何飞镖信息<br>- 不应该收到飞镖信息输入的提示 |
| **实际输出** | - 系统未检测到包头错误<br>- 系统接收并解析了错误数据包<br>- 系统显示了飞镖信息<br>- 用户确认收到了飞镖信息输入 |
| **问题描述** | **问题现象**：<br>当发送包头为0x5511的shoot协议数据包时，系统未进行包头校验，错误地接收并处理了该数据包。用户界面显示收到了飞镖信息，说明系统将错误的数据包当作正常数据包处理。<br><br>**根本原因**：<br>数据传送机模块的shoot协议接收函数中缺少包头校验逻辑，或包头校验逻辑未正确实现。系统没有验证数据包的包头字段是否为规定的0xAA55。<br><br>**影响范围**：<br>1. 数据传送机模块无法拒绝非法数据包<br>2. 可能导致错误的飞镖信息被接受和处理<br>3. 降低系统可靠性和数据完整性<br>4. 在实际应用中可能导致计分错误或游戏异常<br><br>**严重程度**：高 |
| **重现步骤** | 1. 启动Dart.exe被测程序<br>2. 运行测试脚本3_interface_shoot.lua<br>3. 脚本通过COM_shoot串口发送包头错误的数据包（header=0x5511）<br>4. 等待1秒<br>5. 观察系统界面是否显示飞镖信息<br>6. 用户确认：系统显示了飞镖信息（错误行为） |
| **测试脚本** | 测试脚本：`func/3_interface_shoot.lua`<br>执行配置：`run/3_interface_shoot.run`<br>协议定义：`prot/shoot.prot` |
| **修复建议** | 1. **添加包头校验逻辑**：<br>   在shoot协议的数据包接收函数中，首先检查包头字段<br>   ```c<br>   if (packet.header != 0xAA55) {<br>       // 丢弃数据包<br>       LogError("Invalid header: 0x%04X", packet.header);<br>       return ERROR_INVALID_HEADER;<br>   }<br>   ```<br><br>2. **完整的协议校验流程**：<br>   - 第一步：校验包头（0xAA55）<br>   - 第二步：校验数据标志（0xBB）<br>   - 第三步：校验数据长度<br>   - 第四步：校验校验和<br>   - 第五步：校验包尾（0x55AA）<br><br>3. **添加错误日志**：<br>   记录所有被丢弃的数据包，便于调试和分析<br><br>4. **单元测试**：<br>   添加包头错误的单元测试用例，确保修复有效 |
| **附件** | - 测试脚本代码<br>- 错误数据包十六进制：55 11 BB 01 05 [CHECK] 55 AA<br>- 正确数据包十六进制：AA 55 BB 01 05 [CHECK] 55 AA |
| **备注** | **问题编号**：问题1<br>**发现日期**：2024-11-15<br>**测试工程师**：AI测试工程师<br>**优先级**：P0 - 必须修复<br>**预计修复时间**：1个工作日 |

---

### 问题2：靶体接口包头校验缺失

| 项目 | 内容 |
|------|------|
| **需求编号** | 接口需求 |
| **问题等级** | 🔴 高 |
| **测试用例描述** | 测试靶体接口处理错误数据包的能力，验证当发送包头错误的target协议数据包时，系统是否正确进行丢包处理 |
| **输入** | 包头错误的target协议数据包<br>- 包头：0x5511（错误，应为0xAA55）<br>- 数据标志1：0xCC<br>- 投中区域：0x01<br>- 数据标志2：0x11<br>- 校验和：计算正确<br>- 包尾：0x55AA |
| **预期输出** | - 系统检测到包头错误（0x5511 ≠ 0xAA55）<br>- 系统丢弃整个数据包<br>- 系统不显示任何靶区信息<br>- 不应该收到靶体信息的提示 |
| **实际输出** | - 系统未检测到包头错误<br>- 系统接收并解析了错误数据包<br>- 系统显示了靶区信息<br>- 用户确认收到了靶体信息 |
| **问题描述** | **问题现象**：<br>当发送包头为0x5511的target协议数据包时，系统未进行包头校验，错误地接收并处理了该数据包。用户界面显示收到了靶区信息，说明系统将错误的数据包当作正常数据包处理。<br><br>**根本原因**：<br>靶体模块的target协议接收函数中缺少包头校验逻辑，或包头校验逻辑未正确实现。系统没有验证数据包的包头字段是否为规定的0xAA55。<br><br>**影响范围**：<br>1. 靶体模块无法拒绝非法数据包<br>2. 可能导致错误的投中区域信息被接受和处理<br>3. 可能导致计分错误（如误判投中区域）<br>4. 降低系统可靠性和游戏公平性<br>5. 在实际应用中可能被恶意利用<br><br>**严重程度**：高 |
| **重现步骤** | 1. 启动Dart.exe被测程序<br>2. 运行测试脚本4_interface_target.lua<br>3. 脚本通过COM_target串口发送包头错误的数据包（header=0x5511）<br>4. 等待1秒<br>5. 观察系统界面是否显示靶体信息<br>6. 用户确认：系统显示了靶体信息（错误行为） |
| **测试脚本** | 测试脚本：`func/4_interface_target.lua`<br>执行配置：`run/4_interface_target.run`<br>协议定义：`prot/target.prot` |
| **修复建议** | 1. **添加包头校验逻辑**：<br>   在target协议的数据包接收函数中，首先检查包头字段<br>   ```c<br>   if (packet.header != 0xAA55) {<br>       // 丢弃数据包<br>       LogError("Invalid header: 0x%04X", packet.header);<br>       return ERROR_INVALID_HEADER;<br>   }<br>   ```<br><br>2. **完整的协议校验流程**：<br>   - 第一步：校验包头（0xAA55）<br>   - 第二步：校验数据标志1（0xCC）<br>   - 第三步：校验投中区域范围（1-20）<br>   - 第四步：校验数据标志2（0x11）<br>   - 第五步：校验校验和<br>   - 第六步：校验包尾（0x55AA）<br><br>3. **添加错误日志**：<br>   记录所有被丢弃的数据包，便于调试和分析<br><br>4. **单元测试**：<br>   添加包头错误的单元测试用例，确保修复有效<br><br>5. **安全性考虑**：<br>   由于靶体信息直接影响计分，建议添加额外的安全验证机制 |
| **附件** | - 测试脚本代码<br>- 错误数据包十六进制：55 11 CC 01 11 [CHECK] 55 AA<br>- 正确数据包十六进制：AA 55 CC 01 11 [CHECK] 55 AA<br>- 投中区域分值对照表（如有） |
| **备注** | **问题编号**：问题2<br>**发现日期**：2024-11-15<br>**测试工程师**：AI测试工程师<br>**优先级**：P0 - 必须修复<br>**预计修复时间**：1个工作日<br>**注意**：此问题与问题1类似，建议一并修复 |

---

## 📈 问题统计分析

### 按等级分类

| 等级 | 数量 | 百分比 |
|------|------|--------|
| 🔴 高 | 2 | 100% |
| 🟡 中 | 0 | 0% |
| 🟢 低 | 0 | 0% |
| **总计** | **2** | **100%** |

### 按模块分类

| 模块 | 问题数量 | 问题列表 |
|------|---------|---------|
| 数据传送机接口 | 1 | 问题1 |
| 靶体接口 | 1 | 问题2 |
| 其他 | 0 | - |
| **总计** | **2** | - |

### 按类型分类

| 类型 | 数量 | 百分比 |
|------|------|--------|
| 接口校验缺陷 | 2 | 100% |
| 功能缺陷 | 0 | 0% |
| 性能问题 | 0 | 0% |
| 界面问题 | 0 | 0% |
| **总计** | **2** | **100%** |

---

## 🎯 修复优先级建议

### P0 - 必须修复（阻塞问题）

**问题1** 和 **问题2** 均为P0级别，必须在发布前修复。

**理由**：
1. 影响系统核心功能（数据接收与处理）
2. 降低系统可靠性和安全性
3. 可能导致严重的功能异常和计分错误
4. 在实际应用中可能被恶意利用

**修复计划**：
- 修复时间：1-2个工作日
- 修复方式：在协议接收函数中添加包头校验逻辑
- 验证方式：重新运行测试用例03和04，确保通过
- 回归测试：确保修复不影响其他功能

---

## 📋 修复验证清单

### 问题1修复验证

- [ ] 代码审查：包头校验逻辑已添加
- [ ] 单元测试：包头错误测试用例通过
- [ ] 集成测试：测试用例03通过
- [ ] 回归测试：测试用例01、02不受影响
- [ ] 性能测试：修复未影响性能
- [ ] 文档更新：更新接口文档和测试报告

### 问题2修复验证

- [ ] 代码审查：包头校验逻辑已添加
- [ ] 单元测试：包头错误测试用例通过
- [ ] 集成测试：测试用例04通过
- [ ] 回归测试：测试用例01、02不受影响
- [ ] 性能测试：修复未影响性能
- [ ] 文档更新：更新接口文档和测试报告

---

## 🔄 建议的后续测试

### 扩展接口测试

修复当前问题后，建议增加以下测试用例：

1. **包尾错误测试**
   - 测试包尾为0xAA55（错误，应为0x55AA）
   - 验证系统是否正确丢包

2. **数据标志错误测试**
   - shoot协议：data=0xCC（错误，应为0xBB）
   - target协议：data1=0xBB（错误，应为0xCC）或data2=0x22（错误，应为0x11）
   - 验证系统是否正确丢包

3. **校验和错误测试**
   - 构造校验和不匹配的数据包
   - 验证系统是否正确丢包

4. **数据字段边界值测试**
   - type=0, 255
   - number=0, 255
   - zone=0, 21（超出有效范围1-20）
   - 验证系统是否正确处理

5. **数据包长度错误测试**
   - 发送不完整的数据包
   - 发送超长的数据包
   - 验证系统是否正确处理

---

## 📊 测试完成度评估

### 当前测试状态

| 测试类型 | 已测试 | 未测试 | 完成度 |
|---------|--------|--------|--------|
| 基本功能测试 | 2 | 0 | 100% |
| 接口错误处理 | 2 | 5 | 29% |
| 边界值测试 | 0 | 8 | 0% |
| 性能测试 | 0 | 3 | 0% |
| **总计** | **4** | **16** | **20%** |

### 建议测试覆盖目标

- **短期目标**：50%覆盖率（增加10个测试用例）
- **中期目标**：80%覆盖率（增加16个测试用例）
- **长期目标**：95%覆盖率（全面测试）

---

## 📞 联系信息

### 测试团队

- **测试工程师**：AI测试工程师
- **测试主管**：待指定
- **项目经理**：待指定

### 问题跟踪

- **问题跟踪系统**：待定
- **问题状态查询**：待定
- **修复进度通知**：待定

---

## ✅ 报告审批

| 角色 | 姓名 | 签名 | 日期 |
|------|------|------|------|
| 测试工程师 | AI测试工程师 | ✓ | 2024-11-15 |
| 测试主管 | 待审核 | | |
| 项目经理 | 待审核 | | |
| 开发负责人 | 待审核 | | |

---

## 📝 附录

### 附录A：测试环境信息

- **被测软件**：Dart.exe
- **测试框架**：Lua自动化测试框架 V4
- **操作系统**：Windows 10/11
- **串口配置**：9600bps, 8N1
- **测试日期**：2024-11-15

### 附录B：问题报告模板字段说明

本报告按照《CST2025嵌入式分赛--问题报告模板.xlsx》的格式编写，包含以下字段：

1. **需求编号**：关联的需求文档编号
2. **测试用例描述**：详细描述测试场景
3. **输入**：测试输入数据和条件
4. **预期输出**：根据需求的期望结果
5. **实际输出**：实际观察到的结果
6. **问题描述**：详细的问题分析和影响
7. **备注**：补充信息和建议

### 附录C：相关文档

1. 智能飞镖设备_实验报告.md - 完整测试分析报告
2. CST2025嵌入式分赛--省赛--需求文档.pdf
3. CST2025嵌入式分赛--省赛--测试要求.pdf
4. CST2025嵌入式分赛--省赛--评分规则.pdf

---

**报告生成日期**：2024-11-15  
**报告版本**：V1.0  
**状态**：✅ 完成  
**下次更新**：问题修复后进行回归测试

---

*本报告严格按照CST2025嵌入式分赛问题报告模板格式编写*  
*所有问题均经过测试验证，建议优先修复高优先级问题*  
*修复完成后请进行回归测试并更新本报告*
