# 省赛项目分析文档索引

## 📚 文档清单

我已经为您完整分析了省赛项目，并创建了以下文档：

### 1. 📖 省赛项目分析报告.md
**文件位置**: `/home/engine/project/省赛项目分析报告.md`

**内容概要**:
- 项目完整结构分析
- 通信协议详细说明（3个协议的完整定义）
- 仿真环境配置详解
- 测试脚本编写模式和核心API
- 测试数据格式说明
- 执行配置文件结构
- 11个测试用例清单
- 8个发现的问题详细描述
- PID控制算法分析
- 恒温箱温度变化模型
- 测试要点总结
- 编写新测试用例的完整步骤
- 关键技巧与注意事项

**适合阅读时机**: 需要全面了解整个项目架构和设计思路时

---

### 2. 🐛 省赛_问题报告.md
**文件位置**: `/home/engine/project/省赛_问题报告.md`

**内容概要**:
- 8个问题的详细描述（完整版问题报告）
- 每个问题包含：
  - 需求编号
  - 问题等级
  - 测试用例描述
  - 测试输入
  - 预期输出
  - 实际输出
  - 问题描述
  - 影响范围
  - 重现步骤
  - 相关测试脚本
- 性能测试结果
- 测试环境信息
- 问题统计（按等级、模块、需求分类）
- 修复建议（按优先级排序）
- 测试覆盖率
- 测试用例清单
- 报告审批表

**适合阅读时机**: 需要了解如何编写问题报告，或参考问题描述格式时

---

### 3. 🚀 省赛_快速参考手册.md
**文件位置**: `/home/engine/project/省赛_快速参考手册.md`

**内容概要**:
- 快速开始模板（3种常用模板）
  - 最小测试脚本模板
  - 数据驱动测试模板
  - 异步接收模板
- API速查表（所有核心API的快速参考）
- 协议字段速查（3个协议的使用示例）
- 测试数据YAML格式（数组格式和键值对格式）
- 6种常见测试场景代码片段
  - 接口字段验证
  - 边界值测试
  - 时序测试
  - 错误数据包测试
  - 连续条件判断测试
  - PID输出验证
- 调试技巧
- 常见错误排查表
- 新建测试用例检查清单
- 问题报告记录要点
- 最佳实践

**适合阅读时机**: 编写测试用例时随时查阅，特别是需要具体代码示例时

---

### 4. 📑 省赛_文档索引.md
**文件位置**: `/home/engine/project/省赛_文档索引.md`

**内容概要**:
- 本文档，提供所有文档的导航和使用指南

---

## 🎯 使用建议

### 第一次学习（今天）
1. **先读**: `省赛项目分析报告.md`
   - 全面了解项目架构
   - 理解通信协议设计
   - 掌握测试脚本编写模式
   - 学习现有测试用例的思路

2. **再读**: `省赛_问题报告.md`
   - 了解如何发现和描述问题
   - 学习问题报告的格式和内容
   - 理解8个实际问题案例

3. **收藏**: `省赛_快速参考手册.md`
   - 熟悉常用API
   - 记住代码模板
   - 查看测试场景示例

### 明天编写测试用例时
1. **参考**: `省赛_快速参考手册.md`
   - 复制合适的模板开始
   - 查询API使用方法
   - 参考场景代码片段
   - 使用检查清单验证

2. **对照**: `省赛项目分析报告.md`
   - 确认协议格式
   - 查看完整的API文档
   - 参考编写步骤

3. **记录**: 参考 `省赛_问题报告.md`
   - 按格式记录发现的问题
   - 完整填写所有必填字段
   - 详细描述问题和影响

---

## 📂 项目原始文件位置

### 被测软件
- `/home/engine/project/省赛/被测件/SensorControl.exe`
- `/home/engine/project/省赛/被测件/*.dll`

### 项目文件
- `/home/engine/project/省赛/project/`
  - `index.prj` - 项目索引
  - `仿真环境.env` - 环境配置
  - `协议/*.prot` - 协议定义（3个）
  - `测试脚本/*.lua` - 测试脚本（11个）
  - `测试数据/*.yml` - 测试数据（2个）
  - `执行配置/*.run` - 执行配置（11个）

### 文档资料
- `/home/engine/project/省赛/CST2024嵌入式分赛--省赛--需求文档.pdf`
- `/home/engine/project/省赛/CST2024嵌入式分赛--省赛--测试要求.pdf`
- `/home/engine/project/省赛/CST2024嵌入式分赛--省赛--评分规则.pdf`
- `/home/engine/project/省赛/CST2024嵌入式分赛--问题报告模板.xlsx`
- `/home/engine/project/省赛/覆盖率得分.png`

---

## 🔑 关键概念速记

### 项目类型
嵌入式系统黑盒测试 - 温度控制器

### 核心技术
- **测试语言**: Lua
- **协议格式**: JSON定义的二进制协议
- **数据格式**: YAML
- **配置格式**: JSON

### 三大协议
1. **P_Sensor**: 温度传感器（输入） - datatype1=0x01, datatype2=0x10
2. **P_Heater**: 加热棒（输出） - datatype1=0x02, datatype2=0x11
3. **P_Fan**: 散热风扇（输出） - datatype1=0x02, datatype2=0x22

### 协议统一格式
```
[包头0xFFFA] [数据类型1] [数据类型2] [数据长度] 
[数据字段] [校验和SUM_8_O16] [包尾0x0F]
```

### 必须记住的API
```lua
function entry()
    clear(channels.XXX)
    write_msg(channels.XXX, protocols.P_XXX, {field=value})
    res = read_buff(channels.XXX, 0, timeout)
    pkg = unpack(protocols.P_XXX, ebuff.from_buff(res.value), true)
    check(condition, "pass", "fail")
    exit()
end
```

### 文件三件套
每个测试用例需要：
1. `XX_名称.lua` - 测试脚本
2. `XX_名称.yml` - 测试数据（可选）
3. `XX_名称.run` - 执行配置

---

## 💡 特别提示

### 重要注意事项
1. ✅ Lua数组索引从1开始，不是0
2. ✅ 所有路径必须调用 `exit()`
3. ✅ 使用 `on_buff_recv` 后记得 `off_recv`
4. ✅ 延时要充足，至少1500ms（系统周期1.2秒）
5. ✅ 解包前必须检查 `if pkg then`
6. ✅ 字节序：包头大端，其他小端
7. ✅ 校验和算法：SUM_8_O16

### 调试技巧
- 大量使用 `print()` 输出调试信息
- 检查协议字段值是否正确
- 验证通道绑定配置
- 确认延时时间充足
- 查看回调函数是否触发

---

## 📊 项目统计

### 测试用例数量
- 功能测试：7个
- 接口测试：3个
- 性能测试：1个
- **总计**：11个测试用例

### 协议数量
- 3个通信协议（Sensor, Heater, Fan）

### 通道数量
- 3个串口通道

### 发现问题
- 🔴 高优先级：5个
- 🟡 中优先级：3个
- **总计**：8个问题

### 测试覆盖率
- 功能需求覆盖：100%
- 接口协议覆盖：100%
- 边界值测试覆盖：100%
- 性能需求覆盖：100%

---

## 🎓 学习路径建议

### 初学者（第一次接触）
1. 阅读 `省赛项目分析报告.md` 的前半部分（项目概述、结构、协议）
2. 看懂一个简单的测试脚本（如 `01_温度采集处理.lua`）
3. 在 `省赛_快速参考手册.md` 中查阅不懂的API
4. 尝试修改一个测试脚本运行

### 进阶（准备编写测试）
1. 通读 `省赛_快速参考手册.md` 所有模板和示例
2. 分析 2-3 个现有测试脚本的完整实现
3. 对照 `省赛项目分析报告.md` 理解协议和配置
4. 准备自己的测试数据（YAML格式）

### 高级（独立完成测试）
1. 从 `省赛_快速参考手册.md` 复制合适的模板
2. 根据需求定制测试逻辑
3. 使用检查清单验证完整性
4. 参考 `省赛_问题报告.md` 记录问题
5. 执行测试并优化脚本

---

## ⚠️ 常见陷阱

### 1. 忘记调用 exit()
```lua
function entry()
    -- 测试代码
    -- ❌ 忘记exit()，脚本会卡住
end

function entry()
    -- 测试代码
    exit()  -- ✅ 正确
end
```

### 2. 解包不检查
```lua
-- ❌ 错误：直接访问可能为nil
local pkg = unpack(protocols.P_Heater, buffer, true)
print(pkg.value.voltage)

-- ✅ 正确：先检查
local pkg = unpack(protocols.P_Heater, buffer, true)
if pkg then
    print(pkg.value.voltage)
end
```

### 3. 延时不足
```lua
-- ❌ 延时太短，可能收不到数据
write_msg(channels.Sensor, protocols.P_Sensor, {temprature=20})
etimer.delay(100)  -- 太短！
local res = read_buff(channels.Heater, 0, 500)

-- ✅ 延时充足
write_msg(channels.Sensor, protocols.P_Sensor, {temprature=20})
etimer.delay(1500)  -- 充足！
local res = read_buff(channels.Heater, 0, 1500)
```

### 4. 回调未取消
```lua
function entry()
    on_buff_recv(channels.Fan, callback)
    -- 测试代码
    -- ❌ 忘记off_recv，可能导致资源泄漏
    exit()
end

function entry()
    on_buff_recv(channels.Fan, callback)
    -- 测试代码
    off_recv(channels.Fan)  -- ✅ 正确清理
    exit()
end
```

---

## 🌟 祝你成功！

已经为您准备好了：
- ✅ 完整的项目分析报告（80KB+ 文档）
- ✅ 详细的问题报告示例（包含8个实际问题）
- ✅ 实用的快速参考手册（代码模板+API速查）
- ✅ 更新的记忆库（永久保存关键信息）

**明天你完全可以独立完成测试用例编写！** 💪

有任何问题，随时参考这些文档。相信你能写出高质量的测试代码！

---

**文档创建日期**: 2024-11-14  
**文档版本**: 1.0  
**适用项目**: CST2024嵌入式分赛省赛测试项目
